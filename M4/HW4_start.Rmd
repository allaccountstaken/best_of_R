---
title: "Homework4"
author: "Dima Mikhaylow"
date: "9/27/2021"
output: html_document
---


# 1. Questions based on “Copier.txt” dataset.

```{r}
Data = read.table("copier.txt", header=TRUE)
head(Data)
```

It is hypothesized that the total time spent by the service person can be predicted
using the number of copiers serviced. Fit an appropriate linear regression and answer the following questions:

```{r}
result <- lm(Minutes ~ Serviced, data=Data)
```

a.  Produce an appropriate scatterplot and comment on the relationship between the
total time spent by the service person and the number of copiers serviced.

```{r}
library(tidyverse)
ggplot(Data, aes(x=Serviced, y=Minutes))+
  geom_point()+
  theme(axis.text.x=element_text(angle=90))+
  labs(x="Serviced", 
       y="Minutes", 
       title="Scatterplot of time spent and number of serviced devices")

```
## Comment: there seems to be a linear relationship between the variables, as the time spent tends to increase with the number of serviced devices.

b. What is the correlation between the total time spent by the service person and
the number of copiers serviced? Interpret this correlation contextually.

```{r}
cor(Data$Minutes, Data$Serviced)
```

## Comment: correlation of 0.97 supports the possibility of a linear relationship between the variables. Positive sign indicates that they both increase/decrease together, and the value close to 1 suggests that the linear relationship, if present, may be strong.


c. Can the correlation found in part 1b be interpreted reliably? Briefly explain.

## Comment: no, it can't, because it may confuse other nonlinear relationships for a linear relationship. 


d. Obtain the 95% confidence interval for the slope, B1

```{r}
summary(result)$coefficients
```

```{r}

confint(result, level = 0.95)
```

e. Suppose a service person is sent to service 5 copiers. Obtain an appropriate 95%
interval that predicts the total service time spent by the service person.

```{r}
new_data <- data.frame(Serviced=5)
predict(result, new_data, level=0.95, interval="prediction")
```


f. What is the value of the residual for the first observation? Interpret this value
contextually.

```{r}
summary(result)$residuals[1]
```


## Comment: in this case, the residual is equal to a difference between the actual value (Y_i) of the first observation and the predicted value (Y_hat). For the first observation, predicted value is much larger than the actul value and hence residual is negative 9.49. In other words, regression line goes above the first observation and residual indicates a vertical difference between the first observation and predicted value on the regression line for the first observation.


g. What is the average value of the all the residuals? Is this value surprising (or
not)? Briefly explain.

```{r}
anova.tab <- anova(result)
anova.tab[2,3]
```

## Comment: the average value of the all the residuals seems to be very small, but it is not surprising given the overall good fit (large R squared) of the regression line. 

----

# 2.  Calculating the missing values.

a. Carry out a hypothesis test to assess if there is a linear relationship between the
variables of interest..

## Comment: this requires checking if B1 (slope) is statistically different from zero. H0 will be B1=0 and then Ha: B1 != 0 (not zero). If H0 is true than the value of F statistics, i.e Regression Sum of Squares divided by Mean Squared Error, will be close to 1. How close to 1 is 160/2.2 = 72.7? It is very much different, so H0 is likely false, and the slope B1 is in fact different from zero, hence there is a liner relationship between the variables of interest.

```{r}
1 - pt(160/2.2, 8)
```
## Alternatively, t-test for the slop shoud give the same result as F statistics. Check if B1 is not different from zero: t_stat = (B1_hat-0)/se_of_B1_hat. 

Decision criterion:

* Critical region: reject H0 at level of significance of alpha if 
|t| > t_(1-alpha/2; n-2)

```{r}
a = 0.05
n = 10
df = n-2 
qt(1-a/2, df)
```

Checking (B1-0) / se_B1, also squring this value should be eaual to F-stat:

```{r}
((4-0)/0.469) ** 2
```


* P-value approach: the two-sided p-value is 2*P{t_(n-2) > |t|}. If p-value is less than alpha, reject H0.

NOTE: rejecting H0 indicates out data support Ha!

b. Calculate a 95% confidence interval that estimates the unknown value of the
population slope.

## Comment: use statistics+/-(multiplier * s.e. of statistics)


c. A consultant believes the mean number of broken ampules when no transfers
are made is different from 9. Conduct an appropriate hypothesis test (state the
hypotheses statements, calculate the test statistic, and write the corresponding
conclusion in context, in response to his belief).

## Comment: H0: B0 = 9 ??? the mean number of broken ampules is not different 9, and Ha: B0 != 9, the mean number is actually different. To test this, t_stat = (B0_hat - B()/ se_B0_hat

```{r}
(10.2-9) / 0.6633
```

Compared to critical t:

```{r}
qt(1-a/2, df)
```





d. Calculate a 95% confidence interval for the mean number of broken ampules and a 95% prediction interval for the number of broken ampules when the number of transfers is 2.


e. What happens to the intervals from the previous part when the number of transfers is 1? (Describe what happens without calculating).


f. What is the value of the F statistic for the ANOVA table?


g. Calculate the value of R2, and interpret this value in context.

```{r}
160/(160+17.6)
```

## Comment: R2 is close to one. It implies that the model is probably good hence  more than 90% of variance in Y was explained by the regression.


----

# 3. Population slope for a straight-line relationship is 0.

a. Describe how the straight line would look in a plot of y versus x.

## I think it will look like a staight line from y=B0 (intercept) parallel to x.

b. Explain why a slope that is equal to 0 would indicate that y and x are not linearly
related, and why a slope that is not equal to 0 would indicate that y and x are
linearly related.


